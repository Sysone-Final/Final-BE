# 작성자 : 황요한
spring:
  datasource:
    driver-class-name: org.postgresql.Driver
    url: ${DB_URL}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}

    hikari:
      # HikariCP 커넥션 풀 설정
      maximum-pool-size: 50         # 최대 커넥션 수
      minimum-idle: 20              # 최소 유휴 커넥션 수
      connection-timeout: 30000     # 커넥션 획득 대기 시간
      idle-timeout: 300000          # idle 커넥션 유지 시간
      max-lifetime: 600000          # 커넥션 max lifetime
      keepalive-time: 60000         # KeepAlive 주기
      validation-timeout: 5000      # Validation timeout
      connection-test-query: SELECT 1
      leak-detection-threshold: 30000  # 커넥션 누수 감지 시간

  jpa:
    # Hibernate 및 JPA 설정
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: update              # 스키마 자동 업데이트
    show-sql: false                 # SQL 출력 여부
    properties:
      hibernate:
        format_sql: true            # SQL 포맷팅
        use_sql_comments: true      # SQL 주석 표시
        jdbc:
          batch_size: 100           # Batch insert/update 크기
        order_inserts: true         # INSERT 순서 최적화
        order_updates: true         # UPDATE 순서 최적화
    open-in-view: false             # OSIV 비활성화(성능 개선)

  task:
    execution:
      pool:
        # @Async 스레드 풀 설정
        core-size: 8
        max-size: 16
        queue-capacity: 200
        thread-name-prefix: async-executor-
      shutdown:
        await-termination: true
        await-termination-period: 30s

    scheduling:
      # @Scheduled 스레드 풀 설정
      pool:
        size: 10
      thread-name-prefix: scheduler-
      shutdown:
        await-termination: true
        await-termination-period: 30s

monitoring:
  simulator:
    # 모니터링 시뮬레이터 설정
    enabled: true
    interval-seconds: 5000
    device-count: 9
    excluded-equipment-ids: 256,257,258,259
    excluded-rack-ids: 229

  scheduler:
    # 메트릭 수집/통계 스케줄 주기
    metrics-interval: 5000
    statistics-interval: 5000
    datacenter-interval: 5000

prometheus:
  # Prometheus 서버 설정
  base-url: http://112.221.184.61:9090
  timeout: 30s
  collection:
    enabled: true        # Prometheus 수집 활성화
    interval: 5000       # 수집 간격(ms)
  client:
    connect-timeout: 10000  # HTTP 연결 Timeout
    read-timeout: 30000     # 응답 대기 Timeout

jwt:
  # JWT 인증 설정
  secret: ${JWT_SECRET}
  access-token-validity: 7200000       # ACCESS TOKEN 2시간
  refresh-token-validity: 604800000    # REFRESH TOKEN 7일

cookie:
  # Cookie 옵션
  secure: true              # HTTPS에서만 전송

logging:
  # 콘솔 로그 포맷 설정
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} %5p ${PID:- } --- [%15.15t] %-40.40logger{39} : %m%n"
